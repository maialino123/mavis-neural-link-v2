import{r as l,j as t,c as S}from"./assets/client.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const N=(...n)=>n.filter((e,s,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===s).join(" ").trim();const L=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const E=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,r)=>r?r.toUpperCase():s.toLowerCase());const j=n=>{const e=E(n);return e.charAt(0).toUpperCase()+e.slice(1)};var A={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const I=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const M=l.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:o="",children:a,iconNode:c,...m},h)=>l.createElement("svg",{ref:h,...A,width:e,height:e,stroke:n,strokeWidth:r?Number(s)*24/Number(e):s,className:N("lucide",o),...!a&&!I(m)&&{"aria-hidden":"true"},...m},[...c.map(([p,x])=>l.createElement(p,x)),...Array.isArray(a)?a:[a]]));const f=(n,e)=>{const s=l.forwardRef(({className:r,...o},a)=>l.createElement(M,{ref:a,iconNode:e,className:N(`lucide-${L(j(n))}`,`lucide-${n}`,r),...o}));return s.displayName=j(n),s};const O=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],_=f("book-open",O);const R=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],q=f("eye",R);const T=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],z=f("languages",T);const P=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],V=f("send",P);const $=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],W=f("settings",$);class D{ws=null;listeners=[];reqId=1;token="";url="wss://bot.ecomatehome.com";isConnected=!1;constructor(){}init(e,s){this.token=e,s&&(this.url=s),this.connect()}connect(){this.token&&(console.log("Connecting to",this.url),this.ws=new WebSocket(this.url),this.ws.onopen=()=>{console.log("WS Open. Sending Handshake..."),this.sendRequest("connect",{minProtocol:3,maxProtocol:3,client:{id:"openclaw-control-ui",version:"2.0.0",platform:"browser",mode:"ui"},role:"operator",scopes:["operator.read","operator.write","operator.admin"],auth:{token:this.token}})},this.ws.onmessage=e=>{try{const s=JSON.parse(e.data);this.handleMessage(s)}catch(s){console.error("Parse error",s)}},this.ws.onclose=()=>{console.log("WS Closed. Reconnecting in 3s..."),this.isConnected=!1,this.notifyListeners({type:"status",status:"disconnected"}),setTimeout(()=>this.connect(),3e3)})}handleMessage(e){e.type==="res"&&e.payload?.type==="hello-ok"&&(console.log("Neural Link Established!"),this.isConnected=!0,this.notifyListeners({type:"status",status:"connected"})),e.type==="event"&&e.event==="agent.message"&&this.notifyListeners({type:"message",payload:e.payload}),e.type==="res"&&!e.ok&&console.error("Gateway Error:",e.error)}sendChat(e){this.isConnected&&this.sendRequest("agent.chat",{message:e,label:"main"})}sendVision(e){this.isConnected&&this.sendRequest("agent.chat",{message:"I am looking at this page. Please analyze it.",label:"main",attachments:[{name:"screenshot.png",mimeType:"image/png",data:e}]})}sendRequest(e,s){if(!this.ws)return;const r=`req-${this.reqId++}`;this.ws.send(JSON.stringify({type:"req",id:r,method:e,params:s}))}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(s=>s!==e)}}notifyListeners(e){this.listeners.forEach(s=>s(e))}}const u=new D;function v(n){var e,s,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var o=n.length;for(e=0;e<o;e++)n[e]&&(s=v(n[e]))&&(r&&(r+=" "),r+=s)}else for(s in n)n[s]&&(r&&(r+=" "),r+=s);return r}function b(){for(var n,e,s=0,r="",o=arguments.length;s<o;s++)(n=arguments[s])&&(e=v(n))&&(r&&(r+=" "),r+=e);return r}const K="b5b2560e5484e01615681d30470fac5d82d792d849d230ce";function U(){const[n,e]=l.useState([]),[s,r]=l.useState(""),[o,a]=l.useState("disconnected"),c=l.useRef(null),[m,h]=l.useState(!1),[p,x]=l.useState("");l.useEffect(()=>{chrome.storage.local.get(["token"],d=>{const y=d.token||K;x(y),u.init(y)});const i=u.subscribe(d=>{d.type==="status"&&a(d.status),d.type==="message"&&g(d.payload.text,"agent")});return()=>i()},[]);const g=(i,d)=>{e(y=>[...y,{id:Date.now().toString(),text:i,sender:d,timestamp:Date.now()}])},w=()=>{s.trim()&&(g(s,"user"),u.sendChat(s),r(""))},k=async()=>{try{const[i]=await chrome.tabs.query({active:!0,currentWindow:!0});i.windowId&&(g("ðŸ“¸ Capturing vision context...","user"),u.sendChat(`[VISION_CONTEXT] User is looking at: ${i.url}. (Image data omitted for V1 demo)`))}catch(i){console.error(i),g("âŒ Vision capture failed.","agent")}};l.useEffect(()=>{c.current?.scrollIntoView({behavior:"smooth"})},[n]);const C=()=>{chrome.storage.local.set({token:p},()=>{u.init(p),h(!1),g("Token updated. Reconnecting...","agent")})};return m?t.jsxs("div",{className:"flex flex-col h-screen w-full bg-[url('/bg-noise.png')] bg-cover p-4 space-y-4",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Neural Settings"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-xs text-gray-400",children:"Access Token"}),t.jsx("input",{value:p,onChange:i=>x(i.target.value),className:"glass-input w-full font-mono text-xs",placeholder:"Paste your OpenClaw token here"})]}),t.jsxs("div",{className:"flex gap-2 mt-4",children:[t.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white flex-1",children:"Cancel"}),t.jsx("button",{onClick:C,className:"glass-btn flex-1 bg-blue-600",children:"Save & Connect"})]})]}):t.jsxs("div",{className:"flex flex-col h-screen w-full bg-[url('/bg-noise.png')] bg-cover",children:[t.jsxs("header",{className:"flex items-center justify-between px-4 py-3 liquid-glass border-b border-white/5 z-10",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:b("w-2.5 h-2.5 rounded-full shadow-[0_0_10px]",o==="connected"?"bg-emerald-400 shadow-emerald-500/50":"bg-red-400 shadow-red-500/50")}),t.jsx("h1",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300",children:"MAVIS NEURAL LINK"})]}),t.jsx("button",{onClick:()=>h(!0),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:t.jsx(W,{size:18,className:"text-gray-400"})})]}),t.jsxs("main",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.length===0&&t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 opacity-60",children:[t.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-500/20 flex items-center justify-center mb-4 blur-xl absolute"}),t.jsx("img",{src:"/icons/icon128.png",className:"w-16 h-16 mb-4 relative z-10 opacity-80"}),t.jsx("p",{children:"Neural Link Ready."})]}),n.map(i=>t.jsx("div",{className:b("flex w-full",i.sender==="user"?"justify-end":"justify-start"),children:t.jsx("div",{className:b("max-w-[85%] p-3 rounded-2xl text-sm shadow-lg backdrop-blur-md border border-white/5",i.sender==="user"?"bg-blue-600/80 text-white rounded-br-none":"bg-slate-800/60 text-gray-100 rounded-bl-none"),children:i.text})},i.id)),t.jsx("div",{ref:c})]}),t.jsxs("div",{className:"px-4 py-2 flex gap-2 justify-center",children:[t.jsxs("button",{onClick:k,className:"flex flex-col items-center gap-1 p-2 rounded-xl hover:bg-white/5 transition-colors group",children:[t.jsx("div",{className:"p-2 rounded-full bg-purple-500/20 group-hover:bg-purple-500/40 text-purple-300 transition-all",children:t.jsx(q,{size:20})}),t.jsx("span",{className:"text-[10px] text-gray-400",children:"Vision"})]}),t.jsxs("button",{onClick:()=>u.sendChat("Dá»‹ch Ä‘oáº¡n vÄƒn Ä‘ang chá»n sang tiáº¿ng Viá»‡t giÃºp tÃ´i."),className:"flex flex-col items-center gap-1 p-2 rounded-xl hover:bg-white/5 transition-colors group",children:[t.jsx("div",{className:"p-2 rounded-full bg-orange-500/20 group-hover:bg-orange-500/40 text-orange-300 transition-all",children:t.jsx(z,{size:20})}),t.jsx("span",{className:"text-[10px] text-gray-400",children:"Translate"})]}),t.jsxs("button",{onClick:()=>u.sendChat("Táº¡o bÃ i quiz tiáº¿ng Anh tá»« trang nÃ y."),className:"flex flex-col items-center gap-1 p-2 rounded-xl hover:bg-white/5 transition-colors group",children:[t.jsx("div",{className:"p-2 rounded-full bg-emerald-500/20 group-hover:bg-emerald-500/40 text-emerald-300 transition-all",children:t.jsx(_,{size:20})}),t.jsx("span",{className:"text-[10px] text-gray-400",children:"Learn"})]})]}),t.jsx("footer",{className:"p-4 liquid-glass border-t border-white/5",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{value:s,onChange:i=>r(i.target.value),onKeyDown:i=>i.key==="Enter"&&w(),placeholder:"Send a neural command...",className:"glass-input flex-1"}),t.jsx("button",{onClick:w,className:"glass-btn px-3",children:t.jsx(V,{size:18})})]})})]})}S.createRoot(document.getElementById("root")).render(t.jsx(l.StrictMode,{children:t.jsx(U,{})}));
